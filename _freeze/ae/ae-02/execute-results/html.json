{
  "hash": "ff935ab0291f5b29f0e0f2a66635b470",
  "result": {
    "markdown": "---\ntitle: \"Intro statistics and plotting\"\nsubtitle: \"STA 199\"\nformat: html\n---\n\n\n## Bulletin\n\n-   [Office hours](https://docs.google.com/spreadsheets/d/16gf9dQ_41V628vKvFdS95JBOUKYSjuxJBo7OzPye-SI/edit?usp=sharing)\n-   Join [GitHub organization](https://github.com/sta199-sp23-1) if you haven't already\n-   This `ae` is not due for a grade, but when drop/add ends, aes will be graded for completion. You turn in your `aes` by committing to GitHub.\n\n## Getting started\n\nClone *your* `ae2-username` repo from the [GitHub organization](https://github.com/sta199-sp23-1/). If you don't have an `ae2-username` repo, you have not yet accepted your course org invite. You can still clone the *public repo* but note that you won't be able to push.\n\n## Last time\n\n1.  Define *package*, *data frame*, *variable* and *observation*\n\n2.  What's a function?\n    What's an argument?\n\n-   `glimpse(data)`\n-   `mean(x)`\n-   `library(tidyverse)`\n\n3.  How do you print to the screen?\n\n## Today\n\nBy the end of today you will...\n\n- practice using `glimpse()`, `names()`, `nrow()`, `ncol()`, `distinct()`, `count()`\n- define and give examples of *statistics*\n- make visualizations with ggplot\n\n> \"The simple graph has brought more information to the data analyst\\'s mind than any other device\\\" \\\n> - John Tukey\n\n## Load packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\nA package within a package...\n\n- The `tidyverse` package is a collection of packages. `ggplot2` and `dplyr` are two packages contained within `tidyverse`. `ggplot2` contains functions for plotting data while `dplyr` contains tools to wrangle, manipulate and summarize data frames.\n\n## Load data\n\nThe data are stored as a CSV (comma separated values) file in the data folder of your repository. Let’s read it from there and save it as an object called `flint`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflint = read_csv(\"data/flint.csv\")\n```\n:::\n\n\n### Data dictionary\n\n-   `id`: sample ID number (identifies the home)\n-   `zip`: ZIP code in Flint of the sample's location\n-   `ward`: ward in Flint of the sample's location\n-   `draw`: which time point the water was sampled from\n-   `lead`: lead content in parts per billion\n\n## Get to know the data\n\n#### Exercise 1:\n\nLook at the data, how many observations are there? How many variables?\n\n\\[answer here\\]\n\n### `distinct()` and `count()`\n\nLet's use `distinct` to find the number of different time points water was sampled.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistinct(flint, draw)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 1\n  draw  \n  <chr> \n1 first \n2 second\n3 third \n```\n:::\n:::\n\n\nHow many unique homes are in the data set?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflint |>\n  distinct(id)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 269 × 1\n      id\n   <dbl>\n 1     1\n 2     2\n 3     4\n 4     5\n 5     6\n 6     7\n 7     8\n 8     9\n 9    12\n10    13\n# … with 259 more rows\n```\n:::\n:::\n\n\n-   A note on pipes `|>` and `%>%`.\n\n## Exercise 2\n\nFill in the code to `count` how many samples were taken from each zip code. Un-comment the lines (i.e. remove the `#` before running the code)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# flint |>\n # count(______)\n```\n:::\n\n\nWhich ZIP code had the most samples drawn?\n\n\n## Goal\n\nWe want to learn about the **population** using a **sample**.\n\nIn the case we want to learn about the lead content in all of Flint, MI homes but we only have available water readings from a sample of homes (our data set).\n\n### Statistics\n\nWhat is a statistic? It's **any mathematical function of the data**. Sometimes, a statistic is referred to as \"sample statistic\" since you compute it from a **sample** (the data) and not the entire **population**.\n\n#### measure of central tendency:\n\n-   mean\n-   median\n-   mode\n\n#### order statistics:\n\n-   quantiles\n    - minimum (0 percentile)\n    - median (50th percentile)\n    - maximum (100 percentile)\n\n#### measures of spread:\n\n-   variance\n-   standard deviation\n-   range\n-   quartiles\n-   inter-quartile range (IQR)\n\n... and any other arbitrary function of the data you can come up with!\n\n#### Exercise 3:\n\nCome up with your own statistic and write it in the narrative here.\n\nTo access a column of the data, we'll use `data$column`.\n\nLet's compute some of these statistics for `lead` ppb in `R`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# code here\n```\n:::\n\n\n## Intro to plotting\n\nLet's take a look at the **distribution** of lead content in homes in Flint, MI by building a plot, layer by layer.\n\n`ggplot()` creates the initial base coordinate system, and we will add layers to that base. We first specify the data set we will use with `data = flint`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = flint)\n```\n\n::: {.cell-output-display}\n![](ae-02_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThe `mapping` argument is paired with an aesthetic (`aes()`), which tells us how the variables in our data set should be mapped to the visual properties of the graph.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = flint,\n       mapping = aes(x = lead)) # variable(s) we want to look at\n```\n\n::: {.cell-output-display}\n![](ae-02_files/figure-html/flint-histogram-1-1.png){width=672}\n:::\n:::\n\nWe often omit the names of the first two arguments in R functions. So you’ll often see this written as:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(flint, \n       aes(x = lead))\n```\n\n::: {.cell-output-display}\n![](ae-02_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\nThe `geom_xx` function specifies the type of plot we want to use to represent the data. In the code below, we use `geom_histogram` which creates a plot where each observation is represented by a point.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(flint, \n       aes(x = lead)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](ae-02_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nWe can make this plot look nicer by adjusting the number of bins and/or the x-axis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflint |> # data\n  ggplot(aes(x = lead)) + # columns we want to look at\n  geom_histogram(bins = 50) + # geometry of the visualization\n  xlim(0, 100) # limit the x-axis to a certain range\n```\n\n::: {.cell-output-display}\n![](ae-02_files/figure-html/flint-histogram-2-1.png){width=672}\n:::\n:::\n\n\nLet's visualize some of our summary statistics on the plot.\n\n#### Exercise 4:\n\nUn-comment the code below and fill in the blank with the mean.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflint |> \n  ggplot(aes(x = lead)) + \n  geom_histogram(bins = 50) + \n  xlim(0,100) #+\n  #geom_vline(xintercept = __, color = \"red\")\n```\n:::\n\n\nAdd another `geom_vline` with the median. Use a separate color.\n\n## Describing distributions\n\nTo describe a distribution we will use the terms below.\n\n- shape\n    - skewness: right-skewed, left-skewed, symmetric\n    - modality: unimodal, bimodal, multimodal, uniform\n- center: mean (mean), median (median)\n- spread: range (range), standard deviation (sd), interquartile range (IQR)\n- outliers: observations outside the pattern of the data\n\n\n## Box plots\n\nLet's make some plots, where we will focus on zip codes 48503, 48504, 48505, 48506, and 48507. We will restrict our attention to samples with lead values less than 1,000 ppb.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflint_focus <- flint |> \n  filter(zip %in% 48503:48507, lead < 1000)\n```\n:::\n\n\nBelow are side-by-side box plots for the three flushing times in each of the five zip codes we considered. Add `x` and `y` labels; add a title by inserting `title = \"title_name\"` inside the `labs()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = flint_focus, aes(x = factor(zip), y = lead)) +\n  geom_boxplot(aes(fill = factor(draw))) +\n  labs(x = \"--------\", y = \"--------\", fill = \"Flushing time\") +\n  scale_fill_discrete(breaks = c(\"first\", \"second\", \"third\"),\n                      labels = c(\"0 (sec)\", \"45 (sec)\", \"120 (sec)\")) +\n  coord_flip() +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](ae-02_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nAdd labels for `x`, `y`, a `title`, and `subtitle` to the code below to update the corresponding plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = flint_focus, aes(x = factor(zip), y = lead)) +\n  geom_boxplot(aes(fill = factor(draw))) + \n  labs(x = \"--------\", y = \"--------\", fill = \"Flushing time\",\n       subtitle = \"--------\") +\n  scale_fill_discrete(breaks = c(\"first\", \"second\", \"third\"),\n                      labels = c(\"0 (sec)\", \"45 (sec)\", \"120 (sec)\")) +\n  coord_flip(ylim = c(0, 50)) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](ae-02_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nWhat is the difference between the two plots? What are the advantages and disadvantages to each plot?\n\n## References\n\n1.  Langkjaer-Bain, R. (2017). The murky tale of Flint's deceptive water data. Significance, 14: 16-21.\n\n2.  Kelsey J. Pieper, Rebekah Martin, Min Tang, LeeAnne Walters, Jeffrey Parks, Siddhartha Roy, Christina Devine, and Marc A. Edwards Environmental Science & Technology 2018 52 (15), 8124-8132 DOI: 10.1021/acs.est.8b00791",
    "supporting": [
      "ae-02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}