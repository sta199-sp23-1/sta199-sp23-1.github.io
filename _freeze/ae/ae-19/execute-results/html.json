{
  "hash": "61952f6f7d91c8ec99de04ee7bd82088",
  "result": {
    "markdown": "---\ntitle: \"Central limit theorem\"\nsubtitle: \"STA 199\"\neditor: source\nformat: html\nexecute:\n  error: true\n---\n\n\n## Bulletin\n\n-   this `ae` is **due for grade**. Push your completed ae to GitHub within 48 hours to receive credit\n- project proposal feedback\n- [homework 4](/hw/hw-4.html) due date updated\n\n## Getting started\n\nClone *your* `ae19-username` repo from the [GitHub organization](https://github.com/sta199-sp23-1/).\n\n\n## Today\n\nBy the end of today you will...\n\n- Use Central Limit Theorem to define distribution of sample means\n- Calculate probabilities from the normal distribution\n- Use Central Limit Theorem (CLT) to conduct inference on a population mean \n\n\n## Load packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\n```\n:::\n\n\n## Load data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmanhattan = read_csv(\n  \"https://sta101-fa22.netlify.app/static/appex/data/manhattan.csv\"\n  )\n```\n:::\n\n\n\n## Notes\n\nHow do we know when to expect a normal distribution to show up?\n\nLooking at the data from last time, we can see an example where the distribution of **sample means** looked approximately normal but the distribution of **sample medians** does not.\n\nExample:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1)\nboot_dist = manhattan %>%\n  specify(response = rent) %>% \n  generate(reps = 1000, type = \"bootstrap\")\n\nboot_dist %>%\n  calculate(stat = \"mean\") %>%\n  visualize() +\n  labs(x = \"Sample mean\", \n       title = \"Simulated distribution of the sample mean\")\n```\n\n::: {.cell-output-display}\n![](ae-19_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboot_dist %>%\n  calculate(stat = \"median\") %>%\n  visualize() + \n  labs(x = \"Sample median\",\n       title = \"Simulated distribution of the sample median\")\n```\n\n::: {.cell-output-display}\n![](ae-19_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\nAre there times when the sample mean will not look normal?\n\n#### Demo\n\nThe proportion of observed successes for a binary variable is a sample mean. \n\n**Scenario**: You flip a biased coin `numFlips` times and compute the sample mean (the proportion of flips that land heads). You repeat this experiment 1000 times and obtain a distribution of sample means. \n\n- How does the shape of the distribution change as you increase the number of coin flips per sample?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(714)\nnumFlips = 1\nnumHeads = rbinom(n = 1000, size = numFlips, prob = 0.9)\ndf = data.frame(numHeads) # new data frame called df\ndf %>%\nmutate(propHeads = numHeads / numFlips) %>%\nggplot(aes(x = propHeads)) +\ngeom_histogram(binwidth = .01)\n```\n\n::: {.cell-output-display}\n![](ae-19_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## What is the central limit theorem?\n\nThe central limit theorem is a statement about the distribution of the sample mean, $\\bar{x}$.\n\nThe central limit theorem guarantees that, when certain criteria are satisfied, the sample mean ($\\bar{x}$) is normally distributed.\n\nSpecifically, if\n\n1. Observations in the sample are independent. Two rules of thumb to check this:\n\n\t- completely random sampling\n\t- if sampling without replacement, sample should be less than 10% of the population size\n\nand\n\n2. The sample is large enough. The required size varies in different contexts, but some good rules of thumb are: \n\n\t- if the population itself is normal, sample size does not matter.\n\t- if numerical require, >30 observations\n\t- if binary outcome, at least 10 successes and 10 failures.\n\nthen \n\n\n$$\n\\bar{x} \\sim N(\\mu, \\sigma / \\sqrt{n})\n$$\n\n\ni.e. $\\bar{x}$ is normally distributed (unimodal and symmetric with bell shape) with mean $\\mu$ and standard deviation $\\sigma / \\sqrt{n}$. The standard deviation of the sampling distribution is called the **standard error**.\n\n:::{.callout-note}\nThe standard deviation of the sample mean depends on the number of samples, $n$.\n:::\n\n## Practice using CLT & Normal distribution\n\nSuppose the bone density for 65-year-old women is normally \ndistributed with mean $809 mg/cm^3$ and standard deviation of $140 mg/cm^3$.\n\nLet $x$ be the bone density of 65-year-old women. We can write this distribution of $x$ in mathematical notation as \n\n\n$$x \\sim N(809, 140)$$\n\n\n## Visualize the population distribution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = data.frame(x = c(809 - 140*3, 809 + 140*3)), aes(x = x)) +\n  stat_function(fun = dnorm, args = list(mean = 809, sd = 140),\n                color = \"black\") +\n  stat_function(fun = dnorm, args = list(mean = 809, sd = 140/sqrt(10)),\n                color = \"red\",lty = 2) + theme_bw() +\n  labs(title = \"Black solid line = population dist., Red dotted line = sampling dist.\")\n```\n\n::: {.cell-output-display}\n![](ae-19_files/figure-html/visualize-normal-1.png){width=672}\n:::\n:::\n\n\n\n#### Exercise 1\n\nBefore typing any code, based on what you know about the normal distribution, what do you expect the median bone density to be?\n\nWhat bone densities correspond to $Q_1$ (25th percentile), $Q_2$ (50th percentile), and $Q_3$ (the 75th percentile) of this distribution? Use the `qnorm()` function to calculate these values. \n\n#### Exercise 2\n\nThe densities of three woods are below:\n\n- Plywood: 540 mg/cubic centimeter\n- Pine: 600 mg/cubic centimeter\n- Mahogany: 710 mg/cubic centimeter\n\n- What is the probability that a randomly selected 65-year-old woman has bones less dense than Pine?\n\n- Would you be surprised if a randomly selected 65-year-old  woman had bone density less than Mahogany? What if she had bone density less than Plywood? Use the respective probabilities to support your response. \n\n#### Exercise 3\n\nSuppose you want to analyze the mean bone density for a group of 10 randomly selected 65-year-old women. \n\n- Are the conditions for the Central Limit Theorem met?\n\n  - Independence? \n  - Sample size/distribution? \n  \n- What is the shape, center, and spread of the distribution of $\\bar{x}$, the mean bone density for a group of 10 randomly selected 65-year-old women?\n\n- Write the distribution of $\\bar{x}$ using mathematical notation. \n\n#### Exercise 4\n\n- What is the probability that the mean bone density for the group of 10 randomly-selected 65-year-old women is less dense than Pine?\n\n- Would you be surprised if a group of 10 randomly-selected 65-year old women had a mean bone density less than Mahogany? What the group had a mean bone density less than Plywood? Use the respective probabilities to support your response. \n\n#### Exercise 5\n\nExplain how your answers differ in Exercises 3 and 5.\n\n## Extra practice (on your own)\n\nSuppose the distribution of the number of minutes users engage with apps on an iPad has a mean of 8.2 minutes and standard deviation of 1 minute. Let $x$ be the number of minutes users engage with apps on an iPad, $\\mu$ be the population mean and $\\sigma$ the population standard deviation. Then,\n\n\n$$x \\sim N(8.2, 1)$$\n\n\nSuppose you take a sample of 60 randomly selected app users and calculate the mean number of minutes they engage with apps on an iPad, $\\bar{x}$. The conditions (independence & sample size/distribution) to apply the Central Limit Theorem are met. Then by the Central Limit Theorem\n\n\n$$\\bar{x} \\sim N(8.2, 1/\\sqrt{60})$$\n\n\n-   What is the probability a randomly selected user engages with iPad apps for more than 8.3 minutes? Use `pnorm` for calculations.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    #add code\n    ```\n    :::\n\n\n-   What is the probability the mean minutes of app engagement for a group of 60 randomly selected iPad users is more than 8.3 minutes? Use `pnorm` for calculations.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    #add code\n    ```\n    :::\n\n\n-   What is the probability the mean minutes of app engagement for a group of 60 randomly selected iPad users is between 8.3 and 8.4 minutes? Use `pnorm` for calculations. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n    #add code\n```\n:::\n",
    "supporting": [
      "ae-19_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}