{
  "hash": "30d51a0c9ccb29369bc24579666862e2",
  "result": {
    "markdown": "---\ntitle: \"Tidy hypotheses\"\nsubtitle: \"STA 199\"\neditor: source\nformat: html\nexecute:\n  error: true\n---\n\n\n## Bulletin\n\n-   this `ae` is **due for grade**. Push your completed ae to GitHub within 48 hours to receive credit\n- [homework 5](/hw/hw-5.html) released today\n- [project draft report](https://sta199-sp23-1.github.io/project-description.html) due April 7th to your GitHub repo.\n\n## Getting started\n\nClone *your* `ae22-username` repo from the [GitHub organization](https://github.com/sta199-sp23-1/).\n\n## Today\n\nBy the end of today you will...\n\n- hypothesis test the tidy way\n- practice more than testing proportions\n\n\n## Load packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\n```\n:::\n\n\n\n## Notes\n\n### Not just a coin flip\n\n- Here's an example of testing a proportion outside the context of coins.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npush_pull = read_csv(\"https://sta101-fa22.netlify.app/static/appex/data/push_pull.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npush_pull %>%\n  slice(1:3, 24:26)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n  participant_id   age push1 push2 pull1 pull2 training\n           <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <chr>   \n1              1    41    41    45    16    17 density \n2              2    32    35    44     9    11 density \n3              3    44    33    38    10    11 density \n4             24    36    31    60     9    15 gtg     \n5             25    50    35    42     9    12 gtg     \n6             26    34    23    39     9    13 gtg     \n```\n:::\n:::\n\n\n\nThe `push_pull` dataset comes from a \"mini study\" by [mountain tactical institute](https://mtntactical.com/knowledge/mini-study-grease-the-groove-beats-density-for-push-up-pull-up-improvement/). \n\n26 individuals completed 1 of 2 exercise regiments for 3.5 weeks to increase their pushups and pullups. Codebook below:\n\n- `participant_id`: unique identifier for each participant\n- `age`: age of participant\n- `push1/2`: push-ups at beginning and end of program respectively\n- `pull1/2`: pull-ups at beginning and end of program respectively\n- `training`: which training protocol the individual participated in\n\n\n::: {.cell}\n\n```{.r .cell-code}\npush_pull = push_pull %>%\n  mutate(\n    pct_push_inc = (push2 / push1 ) - 1,\n    pct_pull_inc = (pull2 / pull1) - 1)\n```\n:::\n\n\n**Hypothesis**: \"Most people who train consistently will see at least a 15% increase in push-ups over a 3.5 week training period.\"\n\nBreaking it down:\n\n- \"Most\" i.e. \"greater than 50%\" indicates we should examine a proportion.\n\n#### Exercise 1\n\n**What's the null?**\n\n- \"will see at least a 15% increase\". Each person either increases by 15% over 3.5 weeks or does not. This is our binary outcome.\n\n- create a new column called `over_15pct` that tells you whether or not an individual achieved at least a 15% increase in push-ups\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# code here\n```\n:::\n\n\n- What would be a default theory (null hypothesis)?\n\n#### Exercise 2\n\nWrite the null and alternative in mathematical notation.\n\n#### Exercise 3 \n\nWhat is the observed statistic? Compute and write it in mathematical notation.\n\n#### Exercise 4 \n\nNext, simulate under the null and compute the p-value. State your conclusion with $\\alpha = 0.05$. As a bonus, visualize the null distribution and shade in the p-value.\n\n### More than a proportion\n\n- What if we want to make a claim about a different population parameter than a proportion? Maybe a mean, or median? We can't necessarily flip a coin. The answer, is once again, bootstrap sampling.\n\n**Hypothesis**: \"The mean age of push-up/pull-up training participants is greater than 30\".\n\nLet's investigate this hypothesis with a significance level $\\alpha = 0.01$.\n\n#### Exercise 5\n\nWrite down the null and alternative hypotheses in words and mathematical notation\n\n\n#### Exercise 6\n\nWhat is the observed statistic? Write it in mathematical notation.\n\nBootstrapping does the following...\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# find observed statistic\nobs_mean_age = push_pull %>%\n  drop_na(age) %>%\n  summarize(meanAge = mean(age)) %>%\n  pull()\n# subtract observed_mean - desired_mean from age\nage_and_null = push_pull %>%\n  select(age) %>%\n  drop_na(age) %>%\n  mutate(nullAge = age - (obs_mean_age - 30))\n# show data frame\nage_and_null\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 25 × 2\n     age nullAge\n   <dbl>   <dbl>\n 1    41    35.8\n 2    32    26.8\n 3    44    38.8\n 4    37    31.8\n 5    37    31.8\n 6    21    15.8\n 7    33    27.8\n 8    38    32.8\n 9    49    43.8\n10    33    27.8\n# … with 15 more rows\n```\n:::\n\n```{.r .cell-code}\n# show the means of each column\nage_and_null %>%\n  summarize(meanAge = mean(age),\n  mean_nullAge = mean(nullAge))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 2\n  meanAge mean_nullAge\n    <dbl>        <dbl>\n1    35.2           30\n```\n:::\n:::\n\n\nIf we take bootstrap samples from this new `nullAge` column, we are sampling from data with the same\nvariability as our original data, but a different mean. This is a nice way to explore the null!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(3)\n\n# simulate null\nnull_dist = push_pull %>%\n  specify(response = age) %>%\n  hypothesize(null = \"point\", mu = 30) %>%\n  generate(reps = 10000, type = \"bootstrap\") %>%\n  calculate(stat = \"mean\")\n\n# get observed statistic\nobs_stat = obs_mean_age\n\np_value = null_dist %>%\n  get_p_value(obs_stat, direction = \"right\")\n\np_value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  p_value\n    <dbl>\n1  0.0001\n```\n:::\n:::\n\n\n- The p-value 1e-04 is less than $\\alpha = 0.01$. I reject the null hypothesis. In context, there is evidence to suggest\nthat average push/pull trainee age is older than 30 years old.\n\n#### Exercise 7\n\nSay we are interested in the performance of trainees at this particular facility and the sample is representative of the population.\n\n**Hypothesis**: The median number of pull-ups trainees can perform is less than 20 even after training for 3.5 weeks.\n\nWrite down the null and alternative hypothesis in mathematical notation.\n\n#### Exercise 8\n\nWrite down the observed statistic. Simulate under the null and compute the p-value. Finally, visualize and interpret the p-value in context.\n\n\n## Summary\n\n### Hypothesis testing procedure\n\n1. Specify the null and alternative hypothesis. Choose or know $\\alpha$.\n2. Collect/examine the data. Compute the observed statistic.\n3. Simulate **under the null** and compute the p-value using the **observed statistic** and the **alternative hypothesis**.\n4. Compare the p-value to your significance level $\\alpha$ and reject or fail to reject the null. Interpret your result in context.\n\n## Which training method is better?\n\nTwo exercise regimes:\n\n- \"density\" training\n- \"grease-the-groove\" (gtg)\n\nWe want to know, is the average pull-up percent increase of a gtg trainee significantly different than a density trainee?\n\nFundamentally, does the categorical variable `training` affect the average percentage increase in pull-ups?\n\n**State the null hypothesis**:\n\n\n$$\n\\mu_d = \\mu_{gtg}\n$$\n\n$$\nH_0: \\mu_d - \\mu_{gtg} = 0\n$$\n\n\nWhat we want to do to simulate data under this null:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrandom_training = sample(push_pull$training, replace = FALSE)\n\npush_pull %>%\n  select(pct_pull_inc) %>%\n  mutate(random_training = random_training)\n```\n:::\n\n\n\n\n#### Exercise 9:\n\n- Complete the hypothesis specification above by stating the alternative. Check the observed statistic reported below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# code here\n```\n:::\n\n\n\nSimulating under the null and computing the p-value:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim_num = 10000\nset.seed(1)\n# simulate null\nnull_dist = push_pull %>%\n  specify(response = pct_pull_inc, explanatory = training) %>%\n  hypothesize(null = \"independence\") %>%\n  generate(reps = sim_num, type = \"permute\") %>%\n  calculate(stat = \"diff in means\", order = c(\"density\", \"gtg\"))\n# observed statistic\nobs_stat = .196 - .489\n# visualize / get p\nvisualize(null_dist) +\n  shade_p_value(obs_stat, direction = \"both\")\n```\n\n::: {.cell-output-display}\n![](ae-22_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n#### Exercise 10\n\nCompute the p-value and state your conclusion with $\\alpha = 0.05$\n\n## Summary of `generate()` options\n\n#### 1. `draw`\n\n- description: flip a coin with probability p, or roll a die with probabilities associated with each side. [See here](https://cran.r-project.org/web/packages/infer/vignettes/observed_stat_examples.html#one-categorical-2-level---gof) for reference to the multinomial setting.\n- typical case: test the proportion of a binary outcome\n- null: proportion $p$ is some fixed number\n- Example (hypothesis test for a single proportion)\n\n#### 2. `bootstrap`\n\n- description: re-sample your data with replacement\n- typical case (in hypothesis testing): does the mean equal a specific value? Does the median equal a specific value?\n- null: what would the data have looked like if nothing but the point estimate changed?\n\n#### 3. `permute`\n\n- description: permutes variables\n- typical case: is there a difference in the outcome between groups?\n- associated null: group membership does not matter i.e. group A and group B have the same outcome\n- Example (test for independence)",
    "supporting": [
      "ae-22_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}