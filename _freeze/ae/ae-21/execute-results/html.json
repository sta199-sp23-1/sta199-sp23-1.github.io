{
  "hash": "5dfcff79bb34846c2d9734981b892d0f",
  "result": {
    "markdown": "---\ntitle: \"Intro to hypothesis tests\"\nsubtitle: \"STA 199\"\neditor: source\nformat: html\nexecute:\n  error: true\n---\n\n\n## Bulletin\n\n-   this `ae` is **due for grade**. Push your completed ae to GitHub within 48 hours to receive credit\n- [homework 4](/hw/hw-4.html) due today\n- [project draft report](https://sta199-sp23-1.github.io/project-description.html) due April 7th to your GitHub repo.\n\n## Getting started\n\nClone *your* `ae21-username` repo from the [GitHub organization](https://github.com/sta199-sp23-1/).\n\n\n## Today\n\nBy the end of today you will...\n\n- Be familiar with the terms \"p-value\", \"null-distribution\", \"null hypothesis\", \"alternative hypothesis\"\n- Compute a p-value\n\n## Load packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\n```\n:::\n\n\n\n## Introduction to hypothesis testing\n\n### Is this a fair coin?\n\nWe'll record 1 if the coin is \"Heads\" and 0 if the coin lands \"Tails\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# coin_flips = c()\n```\n:::\n\n\nIf the coin is fair, what is the probability of seeing the outcome we saw? To answer this question we'll setup a statistical model:\n\n\n$$\n\\text{\\# heads} \\sim Binomial(n, p)\n$$\n\n\nwhere $p$ is the probability of a heads and $n$ is the total number of coin flips. \n\n#### Exercise 2\n\n- If the coin is fair, what would $p$ be?\n\n- Using `R`, flip a fair coin 6 times and count the number of heads. Next, repeat this experiment 1000 times and count the proportion of times you observe 6 heads.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# code here\n```\n:::\n\n\n- What is the probability of observing 6 heads in 6 coin flips?\n\n\n## Hypothesis testing framework\n\nYou may not have realized it but you just performed a hypothesis test!\n\nYou setup a null hypothesis: $H_0$. The null hypothesis is a hypothesis you set up and then try and knock down. Conceptually, it's the \"nothing special is going on\" hypothesis. Formally, the null hypothesis makes a **claim** or **assumption** about a population parameter. \n\nIn this case, it was the assumption that the coin is fair. Mathematically, we write this:\n\n\n$$\nH_0: p = 0.5\n$$\n\n\nConceptually, $p$ is the probability of flipping a head if we flipped the coin infinitely many times.\n\nSince we computed the probability of observing **all heads**, we were fundamentally interested in if $p > 0.5$. This is our alternative hypothesis, $H_A$. In mathematical notation, we write\n\n\n$$\nH_A: p > 0.5\n$$\n\n\nNext, we **simulated under the null**. This means that we simulated what the coin flips would have looked like **if the null was true**. In this context, this means we simulated as **if the coin was fair**.\n\nFinally, we check to see where our actual observed data places under the null distribution. If it's **way out in the tail**, we reject the null. If its not way out in the tail, we **fail to reject the null**.\n\nHow can we make \"way out in the tail\" more precise? Well, it's arbitrary and context-dependent. In some contexts it is popular to use a cut-off of $0.05$. This cutoff is called \"the significance level\" and is also known as $\\alpha$.\n\n#### Exercise 3\n \nAssume we continue flipping our coin for a total of 30 coin flips and observe 23 heads and 7 tails. What is the probability of seeing 23 **or more** heads if the coin is fair?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# code here\n```\n:::\n\n\n\n## p-values\n\nYou might not realize it, but you just computed a p-value... again!\n\nA p-value is a probability. It's the **tail** probability associated with your alternative hypothesis.\n\nThe alternative hypothesis must always relate to the null. Here we had three options:\n\n- $H_A: p < 0.5$, the coin is biased to land tails\n- $H_A: p > 0.5$, the coin is biased to land heads\n- $H_A: p \\neq 0.5$, the coin is biased\n\nLet's look offline at what each one would like here.\n\n#### Exercise 4\n\nCompute the p-value associated with each of the alternative hypotheses above.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# code here\n```\n:::\n\n\nMake a conclusion based on a significance level of 0.05. In other words, \n\n- if p < 0.05, reject the null.\n- if p > 0.05, we fail to reject the null.\n\nAs you can see our conclusion depends on our alternative hypothesis. For this reason, it is important to set up an alternative hypothesis **before** looking at the data.\n\n\n### Recap \n\nWe were interested in whether or not a coin was fair. We let $p$ be the probability of landing heads. Fundamentally, we were interested in whether or not $p = 0.5$. This was our **null hypothesis**:\n\n\n$$\nH_0: p = .5\n$$\n\n\nand our alternative, was that the coin was biased heads:\n\n$$\nH_A: p > 0.5\n$$\n\n\nIn one example our data consisted of 30 coin flips and 23 heads. The proportion of heads **that we observed**, $\\hat{p} = 23/30 = .77$.\n\nDo these 30 coin flips give us enough evidence to reject the null in favor of the alternative?\n\nTo answer this question, we computed the p-value: $Pr(\\hat{p} \\geq .77 | H_0 \\text{ true})$. In words, the probability that our statistic of interest, ($\\hat{p}$), is greater than or equal to what we saw given that the null is true.\n\nNotice that the p-value is defined by three things:\n\n- our observed statistic (0.77)\n- the null hypothesis ($H_0$) \n- the alternative hypothesis ($H_A$), this tells us *the direction* ($>=$) to shade.\n\nWe compared the p-value to some pre-defined cutoff, $\\alpha$. In our example we set our cutoff at $\\alpha = 0.05$. If p-value $< \\alpha$, we reject the null. If p-value $> \\alpha$, we fail to reject the null.\n\n### The tidy way\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoin_flips = data.frame(one_flip = sample(c(rep(\"H\",23), rep(\"T\", 7)), size = 30))\n\nglimpse(coin_flips)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 30\nColumns: 1\n$ one_flip <chr> \"H\", \"H\", \"H\", \"H\", \"T\", \"H\", \"T\", \"H\", \"H\", \"H\", \"T\", \"H\", \"…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2022)\nnull_dist = \n  coin_flips %>% \n  specify(response = one_flip, success = \"H\") %>%\n  hypothesize(null = \"point\", p = 0.5) %>%\n  generate(reps = 10000, type = \"draw\") %>%\n  calculate(stat = \"prop\")\n\nobs_stat = 23/30\n\nvisualize(null_dist) +\n  shade_p_value(obs_stat, direction = \"right\")\n```\n\n::: {.cell-output-display}\n![](ae-21_files/figure-html/tidy-way-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nnull_dist %>%\nget_p_value(obs_stat, direction = \"right\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  p_value\n    <dbl>\n1  0.0027\n```\n:::\n:::\n\n\np-value of $0.0027 < 0.05$. We reject the null hypothesis that the coin is fair.",
    "supporting": [
      "ae-21_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}